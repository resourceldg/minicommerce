<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cart Counter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .cart-button {
            position: relative;
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #f44336;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        .product {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .add-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 3px;
            cursor: pointer;
        }
        .cart-info {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>üß™ Test Contador del Carrito</h1>
    
    <div class="cart-info">
        <h3>üõí Estado del Carrito</h3>
        <p>Total de items: <span id="cart-total">0</span></p>
        <p>Valor total: $<span id="cart-value">0</span></p>
    </div>

    <button class="cart-button" onclick="showCart()">
        üõí Carrito
        <span id="cart-count" class="cart-count" style="display: none;">0</span>
    </button>

    <h2>üì¶ Productos de Prueba</h2>
    
    <div class="product">
        <h3>Silla Vintage</h3>
        <p>Precio: $150</p>
        <button class="add-btn" onclick="addToCart(1, 'Silla Vintage', 150)">Agregar al Carrito</button>
    </div>

    <div class="product">
        <h3>Mesa de Centro</h3>
        <p>Precio: $300</p>
        <button class="add-btn" onclick="addToCart(2, 'Mesa de Centro', 300)">Agregar al Carrito</button>
    </div>

    <div class="product">
        <h3>C√≥moda Cl√°sica</h3>
        <p>Precio: $450</p>
        <button class="add-btn" onclick="addToCart(3, 'C√≥moda Cl√°sica', 450)">Agregar al Carrito</button>
    </div>

    <button onclick="clearCart()" style="background: #f44336; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 20px;">
        üóëÔ∏è Limpiar Carrito
    </button>

    <script>
        // Simular localStorage
        const CART_KEY = 'test-cart';
        let cart = [];

        // Cargar carrito desde localStorage al iniciar
        function loadCart() {
            const saved = localStorage.getItem(CART_KEY);
            if (saved) {
                try {
                    cart = JSON.parse(saved);
                    updateCartDisplay();
                } catch (error) {
                    console.error('Error loading cart:', error);
                    cart = [];
                }
            }
        }

        // Guardar carrito en localStorage
        function saveCart() {
            try {
                localStorage.setItem(CART_KEY, JSON.stringify(cart));
                console.log('Cart saved:', cart);
            } catch (error) {
                console.error('Error saving cart:', error);
            }
        }

        // Agregar producto al carrito
        function addToCart(id, name, price) {
            console.log('Adding to cart:', name);
            
            const existingItem = cart.find(item => item.id === id);
            
            if (existingItem) {
                existingItem.quantity += 1;
                console.log('Updated existing item quantity');
            } else {
                cart.push({
                    id: id,
                    name: name,
                    price: price,
                    quantity: 1
                });
                console.log('Added new item to cart');
            }
            
            console.log('Current cart:', cart);
            saveCart();
            updateCartDisplay();
        }

        // Actualizar display del carrito
        function updateCartDisplay() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalValue = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            document.getElementById('cart-total').textContent = totalItems;
            document.getElementById('cart-value').textContent = totalValue;
            
            const cartCount = document.getElementById('cart-count');
            if (totalItems > 0) {
                cartCount.textContent = totalItems;
                cartCount.style.display = 'flex';
            } else {
                cartCount.style.display = 'none';
            }
            
            console.log('Cart display updated - Total items:', totalItems, 'Total value:', totalValue);
        }

        // Limpiar carrito
        function clearCart() {
            cart = [];
            saveCart();
            updateCartDisplay();
            console.log('Cart cleared');
        }

        // Mostrar informaci√≥n del carrito
        function showCart() {
            if (cart.length === 0) {
                alert('El carrito est√° vac√≠o');
            } else {
                let message = 'Productos en el carrito:\n\n';
                cart.forEach(item => {
                    message += `${item.name} - Cantidad: ${item.quantity} - Precio: $${item.price}\n`;
                });
                message += `\nTotal: $${cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)}`;
                alert(message);
            }
        }

        // Cargar carrito al iniciar
        loadCart();
        
        console.log('Test cart counter loaded. Current cart:', cart);
    </script>
</body>
</html> 